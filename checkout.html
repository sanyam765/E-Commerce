<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - HearHut</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #f8f9fb 0%, #e9ecef 100%);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }

    .checkout-container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.1);
      border: 1px solid rgba(0,0,0,0.05);
    }

    h2 {
      margin-bottom: 30px;
      text-align: center;
      color: var(--primary-color);
      font-size: 2.2rem;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .order-summary {
      margin-bottom: 40px;
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      padding: 25px;
      border-radius: 15px;
      border: 1px solid rgba(0,0,0,0.05);
    }

    .order-summary h3 {
      margin-bottom: 20px;
      color: var(--text-color);
      font-size: 1.4rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .order-summary h3::before {
      content: 'ðŸ›’';
      font-size: 1.2rem;
    }

    .order-items {
      margin-bottom: 20px;
      border-bottom: 1px solid #e9ecef;
      padding-bottom: 15px;
      color: var(--text-color);
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .order-items:hover {
      background: white;
      margin: 0 -15px;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .order-items:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .checkout-form {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      padding: 30px;
      border-radius: 15px;
      border: 1px solid rgba(0,0,0,0.05);
    }

    .checkout-form label {
      font-weight: 600;
      display: block;
      margin-top: 20px;
      margin-bottom: 8px;
      color: var(--text-color);
      font-size: 1rem;
    }

    .checkout-form input {
      width: 100%;
      padding: 15px;
      margin-top: 5px;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: white;
      box-sizing: border-box;
    }

    .checkout-form input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(0, 114, 255, 0.1);
      transform: translateY(-1px);
    }

    .checkout-form input::placeholder {
      color: #adb5bd;
    }

    .place-order-btn {
      margin-top: 30px;
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, var(--primary-color), #005ecc);
      color: white;
      font-weight: 600;
      border: none;
      border-radius: 15px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(0, 114, 255, 0.3);
      position: relative;
      overflow: hidden;
    }

    .place-order-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }

    .place-order-btn:hover::before {
      left: 100%;
    }

    .place-order-btn:hover {
      background: linear-gradient(135deg, #005ecc, #0047a3);
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(0, 114, 255, 0.4);
    }

    .success-message {
      display: none;
      text-align: center;
      margin-top: 25px;
      padding: 20px;
      background: linear-gradient(135deg, #e0ffe8 0%, #d4f7e0 100%);
      border: 2px solid #00cc6a;
      border-radius: 15px;
      color: #007a33;
      font-weight: 600;
      font-size: 1.1rem;
      box-shadow: 0 8px 25px rgba(0, 204, 106, 0.2);
      animation: slideIn 0.5s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .back-to-cart {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      background: linear-gradient(135deg, #6c757d, #495057);
      color: white;
      padding: 15px 25px;
      border-radius: 12px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      margin-bottom: 20px;
      box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
    }

    .back-to-cart:hover {
      background: linear-gradient(135deg, #495057, #343a40);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
    }

    .total-display {
      background: linear-gradient(135deg, var(--primary-color), #005ecc);
      color: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      margin-bottom: 20px;
      box-shadow: 0 8px 25px rgba(0, 114, 255, 0.2);
    }

    .total-display strong {
      font-size: 1.3rem;
      font-weight: 700;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .checkout-container {
        padding: 25px 20px;
        margin: 10px;
      }
      
      h2 {
        font-size: 1.8rem;
      }
      
      .checkout-form {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="logo">
      <div class="nav-links">
        <div class="hearhut-logo">
          <i class="fas fa-headphones-alt"></i>
          <span>Hear<span class="highlight">Hut</span></span>
        </div>
        <div class="searchbar">
          <i class="fas fa-search" id="searchBtn"></i>
          <input type="text" class="input" id="searchInput" placeholder="Search products....">
          <div id="userSection">
            <a href="signin.html" class="bar" id="signInLink">Sign in</a>
          </div>
        </div>
        <div class="navlinks">
                  <a href="index.html" class="bar">Home</a>
        <a href="contact.html" class="bar">Contact</a>
        <a href="about.html" class="bar">About</a>
          <a href="cart.html" class="bar" id="cart-icon">
            <i class="fas fa-shopping-cart"></i>
            <span id="cart-count">0</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <div class="checkout-container">
    <a href="cart.html" class="back-to-cart">
      <i class="fas fa-arrow-left"></i> Back to Cart
    </a>
    
    <h2>Checkout</h2>

    <!-- Order Summary -->
    <div class="order-summary">
      <h3>Your Order</h3>
      <div id="order-items"></div>
      <div class="total-display">
        <strong>Total: â‚¹<span id="order-total">0</span></strong>
      </div>
    </div>

    <!-- Checkout Form -->
    <form class="checkout-form" id="checkout-form">
      <label>Full Name</label>
      <input type="text" required>

      <label>Email</label>
      <input type="email" required>

      <label>Shipping Address</label>
      <input type="text" required>

      <label>Payment Method</label>
      <input type="text" placeholder="Card / UPI / COD" required>

      <button type="submit" class="place-order-btn">Place Order</button>
    </form>

    <!-- Success Message -->
    <div class="success-message" id="success-message">
      âœ… Your order has been placed successfully! ðŸŽ‰
    </div>
  </div>

<script>
  // Cart functionality
  let cart = JSON.parse(localStorage.getItem("cart")) || [];
  
  function updateCartCount() {
    const cartCount = document.getElementById('cart-count');
    if (cartCount) {
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      cartCount.textContent = totalItems;
    }
  }

  // Initialize cart count
  document.addEventListener('DOMContentLoaded', () => {
    updateCartCount();
    
    // Login handling
    const storedEmail = localStorage.getItem('userEmail');
    const isLoggedIn = localStorage.getItem('isLoggedIn');
    const signInLink = document.querySelector('.searchbar a[href="signin.html"]');

    if (isLoggedIn && storedEmail && signInLink) {
      const username = storedEmail.split('@')[0];
      const userDiv = document.createElement('div');
      userDiv.classList.add('user-info');
      userDiv.style.display = 'flex';
      userDiv.style.alignItems = 'center';
      userDiv.style.gap = '8px';

      const welcomeSpan = document.createElement('span');
      welcomeSpan.textContent = `Welcome, ${username}!`;
      welcomeSpan.style.color = '#fff';
      welcomeSpan.style.fontWeight = '500';
      welcomeSpan.style.fontSize = '14px';

      const logoutBtn = document.createElement('button');
      logoutBtn.textContent = 'Logout';
      logoutBtn.classList.add('logout-btn');
      logoutBtn.style.cssText = `
        background: rgba(255,255,255,0.2);
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 12px;
      `;

      logoutBtn.addEventListener('click', () => {
        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('userEmail');
        localStorage.removeItem('userPassword');
        window.location.reload();
      });

      userDiv.appendChild(welcomeSpan);
      userDiv.appendChild(logoutBtn);
      signInLink.replaceWith(userDiv);
    }
  });

  // Load cart data from localStorage
  const orderItems = document.getElementById("order-items");
  const orderTotal = document.getElementById("order-total");
  let total = 0;

  if(cart.length === 0){
    orderItems.innerHTML = "<p>Your cart is empty!</p>";
  } else {
    cart.forEach(item => {
      total += item.price * item.quantity;
      orderItems.innerHTML += `
        <div class="order-items">
          ${item.name} Ã— ${item.quantity} = â‚¹${(item.price * item.quantity).toFixed(2)}
        </div>
      `;
    });
    orderTotal.textContent = total.toFixed(2);
  }

  // Place order action
  document.getElementById("checkout-form").addEventListener("submit", (e) => {
    e.preventDefault();

    const name = e.target[0].value;
    const email = e.target[1].value;
    const address = e.target[2].value;
    const payment = e.target[3].value;

    const order = {
      id: Date.now(),
      name,
      email,
      address,
      payment,
      cart,
      total: total.toFixed(2),
      date: new Date().toLocaleString()
    };

    // Save order in user-specific localStorage
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    let orders = [];
    
    if (currentUser) {
      orders = JSON.parse(localStorage.getItem(`orders_${currentUser.username}`)) || [];
      orders.push(order);
      localStorage.setItem(`orders_${currentUser.username}`, JSON.stringify(orders));
    } else {
      // Fallback to global orders for backward compatibility
      orders = JSON.parse(localStorage.getItem("orders")) || [];
      orders.push(order);
      localStorage.setItem("orders", JSON.stringify(orders));
    }

    // Show success
    document.getElementById("success-message").style.display = "block";

    // Clear cart
    localStorage.removeItem("cart");
    
    // Also clear user-specific cart
    if (currentUser) {
      localStorage.removeItem(`cart_${currentUser.username}`);
    }

    // Redirect to orders page or homepage
    setTimeout(() => {
      window.location.href = "orders.html";
    }, 2000);
  });
</script>

</body>
</html>
